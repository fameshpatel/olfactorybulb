
from neuron import h

class TransformGC5:
    def __init__(self):

        # Create a section lookup by section name
        # Note: this assumes each section has a unique name
        self.name2section = { sec.name(): sec for sec in h.allsec() }

        # This will store the new section coordinates
        self.section_coords = { }

    def set_coords(self, sec_name):
        # Lookup the section
        nrn_section = self.name2section[sec_name]

        # Lookup its new coords
        new_coords = self.section_coords[sec_name]

        # Use 3D points as section L and diam sources
        h.pt3dconst(1, sec=nrn_section)

        # Clear the existing points - and allocate room for the incoming points
        h.pt3dclear(len(new_coords["diam"]), sec=nrn_section)

        # Use vectorization to add the points to section
        xvec = h.Vector(new_coords["x"])
        yvec = h.Vector(new_coords["y"])
        zvec = h.Vector(new_coords["z"])
        dvec = h.Vector(new_coords["diam"])

        h.pt3dadd(xvec, yvec, zvec, dvec, sec=nrn_section)

    def set_all(self):
        for sec_name in self.section_coords.keys():
            self.set_coords(sec_name)

    @staticmethod
    def apply_on(prefix):
        t = TransformGC5()
        t.define_coords(prefix)
        t.set_all()

    @staticmethod
    def apply():
        t = TransformGC5()
        t.define_coords()
        t.set_all()

    def define_coords(self, prefix = 'GC5[2]'):
        if prefix != '':
            prefix += '.'

        self.section_coords = {
          prefix + 'soma': {
              'x':[-173.614,-173.633,-173.652],
              'y':[763.707,763.228,762.749],
              'z':[-1007.417,-1007.294,-1007.172],
              'diam':[0.990,0.990,0.990]
          },

          prefix + 'apic[0]': {
              'x':[-173.755,-174.365,-175.816,-177.392,-178.449,-179.423,-180.819,-182.447,-183.838,-184.915,-185.741,-187.062,-187.843,-188.664,-190.296,-191.447,-192.215,-193.672,-195.350,-196.947,-198.127,-198.837,-200.646,-202.310,-203.992,-205.334,-207.021,-208.489,-209.684,-210.737,-212.031,-213.633,-215.636,-217.776,-219.318,-220.486,-221.202,-222.041,-222.886,-223.701,-224.501,-225.513,-227.376,-228.989,-230.575,-232.207,-234.340,-235.850,-237.212,-239.000,-239.924,-241.666,-243.000,-244.232,-245.490,-246.822,-248.128,-249.525,-250.982,-252.094,-253.136,-255.072,-256.307,-257.154,-258.519,-259.866,-261.880,-263.175,-263.935,-265.479,-266.933,-268.483,-269.343,-270.375,-272.201,-274.240,-276.432,-278.661,-280.324],
              'y':[762.788,761.488,760.979,760.518,760.176,759.838,759.359,758.776,758.195,757.534,757.185,756.722,756.182,755.889,755.450,755.110,754.713,754.243,753.900,753.514,753.051,752.264,751.297,750.762,750.328,750.039,749.780,749.516,749.302,749.157,748.922,748.587,748.024,747.477,747.353,747.926,748.639,749.203,749.685,750.097,750.277,750.111,749.740,749.572,749.639,749.378,749.021,748.873,748.963,749.159,749.756,750.098,750.636,751.188,751.219,751.627,752.110,752.084,752.006,752.081,752.708,752.960,753.509,754.151,754.584,754.983,755.241,755.781,756.490,756.914,757.395,757.891,758.574,758.668,758.469,758.204,757.852,757.559,757.198],
              'z':[-1007.145,-1006.377,-1005.770,-1005.053,-1004.391,-1003.753,-1003.080,-1002.444,-1001.878,-1000.855,-999.752,-998.558,-997.533,-996.966,-996.257,-995.601,-994.526,-993.328,-992.597,-991.897,-991.306,-990.473,-989.440,-988.782,-988.066,-987.372,-986.137,-985.431,-984.753,-984.086,-983.385,-982.669,-981.968,-981.355,-980.900,-980.448,-980.332,-980.584,-980.991,-981.456,-982.077,-982.149,-981.833,-981.598,-981.867,-981.664,-981.256,-981.105,-981.523,-981.631,-981.753,-981.551,-981.231,-980.983,-980.789,-980.917,-980.965,-980.752,-980.578,-980.399,-980.269,-979.936,-979.603,-979.698,-979.806,-979.939,-979.711,-979.292,-979.188,-979.138,-978.950,-978.562,-978.318,-977.990,-977.425,-976.805,-976.105,-975.289,-974.312],
              'diam':[0.592,0.736,0.674,0.491,0.480,0.643,0.582,0.357,0.245,0.245,0.307,0.491,0.715,0.787,0.664,0.715,0.664,0.888,0.787,0.736,0.613,0.613,0.909,0.837,0.837,0.766,0.787,0.613,0.491,0.541,0.715,0.909,0.981,0.858,0.552,0.245,0.245,0.307,0.368,0.368,0.541,0.766,0.939,0.888,0.909,0.766,0.694,0.643,0.592,0.429,0.480,0.541,0.541,0.643,0.541,0.541,0.694,0.694,0.582,0.357,0.552,0.613,0.491,0.715,0.766,0.694,0.357,0.307,0.592,0.491,0.643,0.541,0.715,0.837,0.766,0.694,0.694,0.694,0.419]
          },

          prefix + 'apic[5]': {
              'x':[-374.579,-377.083,-378.270,-378.843,-379.832,-381.295,-382.914,-384.078,-384.722,-385.032,-385.467,-385.840,-386.682,-388.381,-390.224,-392.147,-394.300,-395.761,-397.221,-399.188],
              'y':[789.100,788.498,787.892,787.214,786.671,786.248,785.714,785.262,784.716,784.359,784.538,784.572,784.427,784.008,783.510,782.991,782.430,782.083,781.738,781.690],
              'z':[-971.300,-970.613,-969.998,-969.125,-968.077,-967.388,-966.694,-966.088,-965.137,-964.210,-962.820,-961.842,-961.273,-960.557,-959.796,-959.037,-958.280,-957.847,-957.404,-957.050],
              'diam':[0.613,0.787,0.755,0.743,0.732,0.722,0.713,0.707,0.701,0.697,0.692,0.688,0.684,0.678,0.672,0.665,0.659,0.652,0.652,0.652]
          },

          prefix + 'apic[7]': {
              'x':[-399.188,-400.528,-401.349,-402.642,-404.238,-406.022,-408.337,-411.111,-413.579,-415.828,-418.140,-419.833,-420.584,-420.916,-421.323,-422.138,-423.660,-425.581,-427.645,-429.837,-431.375,-432.274,-433.668,-435.643,-437.463,-438.950],
              'y':[781.690,780.576,780.198,779.703,779.394,779.094,778.600,777.883,777.161,776.487,775.890,775.459,775.170,774.974,774.732,774.428,773.932,773.286,772.682,772.205,772.007,771.950,771.740,771.317,770.855,770.445],
              'z':[-957.050,-956.030,-955.425,-954.300,-953.602,-952.920,-952.220,-951.497,-950.852,-950.248,-949.529,-948.812,-947.761,-946.763,-945.760,-944.673,-943.954,-943.242,-942.517,-941.769,-941.115,-940.551,-939.884,-939.070,-938.281,-937.540],
              'diam':[0.652,0.641,0.639,0.635,0.631,0.626,0.621,0.615,0.610,0.605,0.600,0.597,0.594,0.592,0.590,0.588,0.585,0.581,0.577,0.573,0.571,0.569,0.567,0.563,0.560,0.557]
          },

          prefix + 'apic[8]': {
              'x':[-374.579,-375.380,-376.173,-376.982,-377.816,-378.635,-379.451,-380.190,-381.160,-382.237,-383.181,-384.112,-385.217,-386.930,-388.140,-388.942,-390.224,-391.237,-392.137,-393.645,-394.507,-395.251,-395.957,-396.748,-398.375,-399.919,-400.873,-401.708,-402.720,-403.640,-404.516,-405.709,-406.872,-407.665,-409.077,-410.198,-411.088,-411.904,-412.501,-413.133,-415.798,-417.194,-418.203,-418.977,-420.721,-422.165,-424.313,-425.479,-426.172,-427.120,-428.388,-429.501,-431.482,-433.343,-434.456,-435.451,-436.666,-437.931,-438.696,-439.481,-440.406,-441.678,-443.483,-444.692,-445.651,-446.549,-447.097,-447.278,-447.222,-446.923,-446.538,-446.122,-445.718,-444.547,-442.078,-440.085,-439.225,-438.195,-436.034,-433.414,-431.649,-430.961,-429.184,-427.238,-425.295,-424.279],
              'y':[789.100,789.465,790.050,790.855,791.674,792.309,793.120,794.043,794.904,795.633,796.401,797.116,797.760,798.052,798.498,799.095,799.424,799.668,800.234,800.138,800.132,800.524,800.835,801.203,801.163,801.388,801.979,802.507,803.123,804.230,804.831,804.838,804.811,805.311,805.602,805.567,805.578,805.859,806.238,806.795,806.824,806.854,807.355,807.932,808.235,808.658,808.412,808.046,807.779,807.552,807.231,807.037,806.658,806.401,806.487,806.652,806.705,807.105,807.464,807.755,808.112,808.578,808.918,809.492,810.600,811.566,812.684,813.981,815.210,816.288,817.676,818.652,819.620,820.283,821.104,821.762,822.189,822.599,823.174,823.802,824.272,824.627,825.234,825.780,826.358,826.830],
              'z':[-971.300,-971.796,-972.727,-973.468,-974.187,-975.087,-975.818,-976.477,-977.081,-977.767,-978.495,-979.274,-980.014,-980.035,-980.214,-980.503,-980.763,-981.263,-982.170,-982.447,-983.055,-984.137,-985.234,-986.291,-986.555,-986.742,-987.617,-987.944,-987.921,-987.561,-987.090,-986.626,-986.081,-985.362,-984.481,-983.890,-983.316,-982.360,-981.500,-980.939,-980.212,-979.900,-980.086,-980.352,-980.297,-980.305,-980.223,-980.749,-981.455,-982.079,-982.613,-982.682,-982.387,-982.053,-981.814,-981.533,-981.268,-981.435,-981.987,-982.559,-983.011,-983.111,-982.773,-982.442,-982.466,-982.923,-983.313,-983.403,-983.006,-982.286,-982.126,-982.070,-982.147,-982.637,-983.638,-984.513,-985.074,-985.647,-986.355,-987.133,-987.842,-988.871,-990.066,-990.763,-991.206,-991.257],
              'diam':[0.613,0.653,0.429,0.245,0.245,0.429,0.429,0.480,0.837,0.245,0.307,0.245,0.480,0.541,0.307,0.307,0.592,0.429,0.480,0.480,0.307,0.307,0.307,0.909,0.909,0.480,0.491,0.736,0.592,0.715,0.766,0.643,0.592,0.694,0.766,0.837,0.766,0.694,0.694,0.837,0.725,0.491,0.429,0.552,0.664,0.909,0.613,0.491,0.491,0.643,0.909,0.981,0.909,0.837,0.909,0.858,0.613,0.541,0.643,0.491,0.541,0.766,0.837,0.715,0.491,0.491,0.429,0.480,0.766,0.909,0.541,0.491,0.643,0.694,0.694,0.694,0.694,0.766,0.837,0.653,0.357,0.552,0.837,0.837,0.715,0.541]
          },

          prefix + 'apic[6]': {
              'x':[-399.188,-400.384,-401.576,-402.682,-403.660,-404.584,-405.582,-406.998,-407.588,-408.222,-408.667,-409.262,-409.934,-410.580,-411.271,-411.929,-412.420,-413.442,-414.951,-417.103,-418.675,-420.113,-421.724,-424.107],
              'y':[781.690,781.865,782.403,782.538,782.714,783.369,783.985,784.390,784.959,785.841,786.770,787.770,788.951,790.052,791.079,792.060,792.647,793.504,793.380,793.064,793.002,793.494,793.419,793.065],
              'z':[-957.050,-956.866,-956.854,-956.557,-956.229,-955.894,-955.829,-955.542,-954.886,-953.916,-952.979,-952.207,-951.889,-951.339,-950.561,-949.731,-949.076,-948.184,-947.702,-947.156,-946.767,-946.406,-945.954,-945.275],
              'diam':[0.652,0.634,0.626,0.620,0.616,0.612,0.608,0.604,0.601,0.597,0.594,0.591,0.588,0.585,0.582,0.580,0.578,0.575,0.572,0.568,0.566,0.564,0.561,0.557]
          },

          prefix + 'apic[4]': {
              'x':[-301.587,-303.180,-304.444,-305.425,-307.028,-309.158,-310.505,-311.977,-312.909,-313.646,-315.549,-317.089,-318.488,-319.703,-320.871,-322.536,-323.574,-324.682,-325.876,-326.940,-327.797,-328.681,-329.445,-330.524,-332.143,-334.150,-335.333,-336.149,-336.899,-338.067,-339.095,-340.685,-342.006,-343.327,-344.680,-345.533,-346.117,-346.957,-347.663,-348.621,-349.552,-350.575,-351.598,-352.400,-353.358,-354.952,-356.318,-357.209,-357.976,-358.755,-359.550,-360.672,-361.773,-362.665,-363.622,-364.611,-365.483,-366.251,-367.095,-368.313,-369.437,-370.306,-371.272,-372.480,-373.458,-374.579],
              'y':[766.492,766.292,766.132,766.376,766.557,766.687,766.659,767.034,767.679,768.392,768.679,768.614,768.557,768.940,769.453,769.868,769.968,770.049,770.382,770.998,771.613,772.293,772.993,773.536,773.359,773.081,773.138,773.822,774.533,775.133,775.299,775.747,775.742,775.710,776.099,776.501,776.842,777.274,777.972,779.082,779.666,780.201,780.497,780.534,780.560,780.642,780.804,780.885,781.081,781.328,781.593,782.130,782.810,783.003,783.607,784.084,784.481,784.916,785.338,785.797,786.301,786.848,787.374,787.836,788.355,789.100],
              'z':[-967.852,-967.630,-967.621,-968.126,-968.363,-968.343,-968.265,-968.339,-968.199,-967.932,-967.308,-966.777,-966.207,-965.385,-964.851,-964.600,-964.515,-964.444,-964.782,-965.573,-965.690,-965.474,-965.368,-965.417,-965.083,-964.538,-964.143,-963.865,-963.775,-963.563,-963.308,-962.868,-962.409,-961.870,-961.102,-960.270,-959.380,-958.612,-958.303,-958.319,-958.488,-958.714,-959.132,-959.794,-960.417,-960.712,-961.045,-961.675,-962.326,-962.927,-963.521,-964.364,-965.052,-966.094,-966.931,-967.851,-968.303,-968.792,-969.245,-969.426,-969.626,-969.921,-970.195,-970.390,-970.660,-971.300],
              'diam':[0.981,0.981,0.858,0.541,0.909,0.766,0.694,0.419,0.491,0.766,0.939,0.827,0.480,0.552,0.858,0.643,0.694,0.643,0.307,0.491,0.592,0.491,0.368,0.643,0.694,0.582,0.357,0.245,0.429,0.592,0.592,0.787,0.613,0.429,0.307,0.541,0.643,0.592,0.429,0.480,0.694,0.787,0.541,0.541,0.643,0.592,0.694,0.541,0.491,0.491,0.368,0.491,0.307,0.245,0.245,0.429,0.491,0.491,0.613,0.715,0.429,0.429,0.643,0.694,0.592,0.613]
          },

          prefix + 'apic[1]': {
              'x':[-280.324,-281.494,-282.258,-282.445,-282.841,-283.318,-283.652,-285.006,-285.977,-287.758,-289.545,-291.408,-292.675,-293.796,-295.184,-295.407,-297.070,-297.813,-298.035,-298.290,-298.593,-298.775,-298.957,-299.222,-299.504,-299.714,-299.852,-299.688,-299.645,-299.923,-300.341,-300.526,-300.493,-300.356,-300.258,-300.291,-300.336,-300.381,-300.473,-300.479,-300.420,-300.221,-299.881],
              'y':[757.198,756.862,756.203,755.335,754.897,754.695,754.719,754.439,754.232,753.701,753.284,752.980,752.952,753.355,752.994,752.396,751.695,751.325,751.051,750.872,749.966,749.395,748.573,748.228,747.991,747.560,746.512,745.891,745.602,745.601,745.652,745.499,745.467,745.368,745.126,744.931,744.947,744.711,744.668,744.392,744.018,743.540,742.800],
              'z':[-974.312,-973.527,-972.650,-971.498,-970.555,-969.522,-968.545,-967.379,-966.254,-964.964,-964.183,-963.444,-962.883,-962.156,-961.255,-960.462,-959.331,-958.290,-957.339,-955.937,-954.797,-953.986,-952.796,-951.860,-950.878,-949.999,-949.023,-947.874,-946.540,-945.144,-944.153,-942.749,-941.404,-940.077,-938.756,-937.394,-936.031,-934.667,-933.288,-931.950,-930.635,-929.418,-928.389],
              'diam':[0.419,0.368,0.245,0.245,0.307,0.429,0.307,0.592,0.613,0.981,0.797,0.429,0.307,0.531,0.245,0.480,0.480,0.245,0.245,0.245,0.245,0.245,0.429,0.592,0.541,0.643,0.245,0.429,0.480,0.981,0.909,0.368,0.429,0.245,0.245,0.245,0.245,0.245,0.307,0.592,0.429,0.715,0.981]
          },

          prefix + 'apic[2]': {
              'x':[-280.324,-280.575,-281.327,-282.411,-283.187,-284.009,-285.082,-286.139,-287.418,-288.702,-289.794,-291.112,-292.956,-294.312,-295.593,-296.773,-297.745,-298.667,-299.698,-300.543,-301.587],
              'y':[757.198,758.236,758.939,759.973,760.683,761.822,762.914,763.512,764.036,764.109,764.256,764.806,765.175,765.189,765.165,765.030,764.885,764.825,765.254,766.382,766.492],
              'z':[-974.312,-975.032,-974.939,-975.080,-975.048,-974.746,-974.579,-974.258,-973.710,-973.344,-973.033,-972.697,-972.139,-971.681,-971.182,-970.582,-969.949,-969.382,-968.667,-968.220,-967.852],
              'diam':[0.419,0.245,0.245,0.491,0.307,0.307,0.766,0.981,0.613,0.491,0.491,0.766,1.133,1.032,0.909,0.888,1.062,1.133,0.715,0.715,0.981]
          },

          prefix + 'apic[3]': {
              'x':[-301.587,-301.511,-301.977,-302.723,-303.368,-303.867,-304.347,-304.851,-305.395,-306.100,-306.722,-307.548,-308.065,-309.888,-311.339,-312.706,-313.810,-314.592,-315.150,-315.684,-316.288,-316.660,-317.153,-317.735,-318.337,-319.033,-320.028,-320.981,-322.000,-322.906,-323.620,-324.347,-324.846,-325.438,-325.926,-326.454,-326.684,-326.547,-326.210,-326.028,-326.214,-327.449,-328.191,-328.791,-329.439,-330.226,-330.763,-331.309,-331.896,-332.614,-333.394,-334.054,-334.448,-334.789,-334.979,-335.428,-335.866,-336.002,-336.329,-336.844,-337.354,-337.676,-338.050,-338.514,-339.223,-340.072,-341.338,-341.937,-342.492,-343.111,-343.642,-344.165,-344.611,-345.088,-346.273,-347.387,-348.046,-349.061,-350.520,-351.952,-352.832,-353.633,-354.563,-355.573,-355.992,-355.625,-355.643,-355.712,-356.565,-358.406,-360.172,-361.344,-362.619,-363.695,-364.236,-364.644,-365.149,-365.515,-366.376,-367.418,-368.402,-368.880,-369.482],
              'y':[766.492,767.111,768.000,769.013,770.090,771.019,771.784,772.417,773.521,774.655,775.385,776.399,776.909,776.944,776.783,776.639,776.584,776.846,777.541,778.130,779.109,780.100,781.133,782.209,783.207,784.215,785.094,785.047,784.896,784.916,785.537,786.548,787.146,788.082,789.004,790.020,791.121,791.915,792.923,793.816,794.261,794.448,794.835,795.861,796.722,797.779,798.779,799.737,800.395,801.496,802.502,803.533,804.584,805.517,806.186,806.761,807.174,807.392,807.912,808.383,808.829,809.464,810.088,810.455,810.753,810.765,811.044,812.067,813.181,814.354,815.555,816.425,816.968,817.332,817.707,818.277,818.971,819.410,819.367,819.300,819.592,819.912,819.940,820.159,820.843,821.392,822.177,823.119,823.561,823.280,823.042,823.030,822.902,822.655,822.303,822.170,822.246,822.421,822.488,822.439,822.727,823.136,823.633],
              'z':[-967.852,-966.992,-966.029,-965.238,-964.597,-963.672,-962.576,-961.985,-961.348,-960.873,-960.535,-959.835,-959.100,-958.004,-957.332,-956.677,-956.071,-955.147,-953.996,-953.366,-952.502,-951.648,-950.893,-950.241,-949.416,-948.630,-947.748,-947.231,-946.653,-946.185,-945.695,-944.926,-944.273,-943.368,-942.422,-941.645,-940.973,-939.963,-939.166,-938.340,-937.133,-936.135,-935.295,-934.542,-933.552,-932.914,-932.068,-931.186,-930.685,-930.124,-929.345,-928.594,-927.839,-926.909,-925.747,-924.514,-923.205,-921.855,-920.594,-919.817,-919.011,-917.828,-916.612,-915.749,-914.825,-914.248,-913.324,-912.548,-911.955,-911.589,-911.267,-910.311,-909.039,-908.194,-907.373,-906.887,-906.490,-905.738,-905.173,-904.595,-903.695,-902.837,-902.304,-901.330,-900.104,-899.259,-898.202,-897.297,-896.604,-895.939,-895.255,-894.736,-894.186,-893.580,-892.555,-891.553,-890.555,-889.608,-888.581,-888.008,-887.100,-886.279,-885.653],
              'diam':[0.981,0.491,0.613,0.480,0.245,0.245,0.429,0.307,0.245,0.858,0.715,0.368,0.613,1.083,1.083,1.133,1.062,0.541,0.592,0.491,0.245,0.245,0.715,0.541,0.541,0.715,0.837,0.766,0.643,0.480,0.429,0.480,0.480,0.245,0.429,0.307,0.429,0.491,0.307,0.368,0.541,0.541,0.307,0.480,0.491,0.491,0.245,0.491,0.429,0.307,0.643,0.245,0.429,0.368,0.307,0.368,0.643,0.368,0.858,0.858,0.429,0.307,0.643,0.541,0.694,0.643,0.429,0.245,0.245,0.245,0.307,0.245,0.643,0.694,0.643,0.491,0.541,0.592,0.592,0.541,0.491,0.643,0.694,0.643,0.507,0.515,0.521,0.526,0.529,0.534,0.537,0.540,0.542,0.544,0.546,0.547,0.549,0.550,0.552,0.553,0.555,0.556,0.557]
          },


        }
