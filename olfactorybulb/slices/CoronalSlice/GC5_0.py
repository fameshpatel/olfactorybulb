
from neuron import h

class TransformGC5:
    def __init__(self):

        # Create a section lookup by section name
        # Note: this assumes each section has a unique name
        self.name2section = { sec.name(): sec for sec in h.allsec() }

        # This will store the new section coordinates
        self.section_coords = { }

    def set_coords(self, sec_name):
        # Lookup the section
        nrn_section = self.name2section[sec_name]

        # Lookup its new coords
        new_coords = self.section_coords[sec_name]

        # Use 3D points as section L and diam sources
        h.pt3dconst(1, sec=nrn_section)

        # Clear the existing points - and allocate room for the incoming points
        h.pt3dclear(len(new_coords["diam"]), sec=nrn_section)

        # Use vectorization to add the points to section
        xvec = h.Vector(new_coords["x"])
        yvec = h.Vector(new_coords["y"])
        zvec = h.Vector(new_coords["z"])
        dvec = h.Vector(new_coords["diam"])

        h.pt3dadd(xvec, yvec, zvec, dvec, sec=nrn_section)

    def set_all(self):
        for sec_name in self.section_coords.keys():
            self.set_coords(sec_name)

    @staticmethod
    def apply_on(prefix):
        t = TransformGC5()
        t.define_coords(prefix)
        t.set_all()

    @staticmethod
    def apply():
        t = TransformGC5()
        t.define_coords()
        t.set_all()

    def define_coords(self, prefix = 'GC5[0]'):
        if prefix != '':
            prefix += '.'

        self.section_coords = {
          prefix + 'apic[7]': {
              'x':[-451.962,-453.702,-454.729,-456.405,-458.169,-460.098,-462.538,-465.428,-468.010,-470.370,-472.825,-474.697,-475.828,-476.546,-477.339,-478.544,-480.269,-482.369,-484.601,-486.946,-488.628,-489.679,-491.236,-493.403,-495.424,-497.116],
              'y':[645.558,645.460,645.327,644.932,644.967,645.078,645.420,645.968,646.481,646.938,647.292,647.380,646.799,646.090,645.416,644.831,644.877,645.114,645.379,645.629,645.648,645.481,645.442,645.542,645.621,645.609],
              'z':[-393.815,-394.835,-395.167,-395.634,-395.761,-395.836,-395.988,-396.260,-396.584,-396.897,-397.152,-397.379,-397.747,-398.103,-398.487,-398.865,-399.189,-399.570,-399.885,-400.058,-400.081,-400.082,-400.149,-400.333,-400.578,-400.834],
              'diam':[0.652,0.641,0.639,0.635,0.631,0.626,0.621,0.615,0.610,0.605,0.600,0.597,0.594,0.592,0.590,0.588,0.585,0.581,0.577,0.573,0.571,0.569,0.567,0.563,0.560,0.557]
          },

          prefix + 'apic[2]': {
              'x':[-339.122,-338.961,-339.613,-340.442,-341.091,-341.845,-342.780,-343.811,-345.142,-346.452,-347.557,-348.837,-350.703,-352.121,-353.490,-354.818,-355.971,-357.043,-358.223,-359.057,-360.145],
              'y':[626.517,626.931,626.900,627.094,627.125,626.802,626.702,626.608,626.413,626.518,626.580,626.580,626.621,626.687,626.701,626.624,626.448,626.287,625.886,625.446,625.453],
              'z':[-437.758,-436.549,-435.747,-434.507,-433.679,-432.499,-431.280,-430.569,-429.936,-429.685,-429.392,-428.676,-428.074,-427.887,-427.761,-427.786,-427.872,-427.872,-427.420,-426.282,-426.047],
              'diam':[0.419,0.245,0.245,0.491,0.307,0.307,0.766,0.981,0.613,0.491,0.491,0.766,1.133,1.032,0.909,0.888,1.062,1.133,0.715,0.715,0.981]
          },

          prefix + 'apic[1]': {
              'x':[-339.122,-340.535,-341.646,-342.361,-343.140,-344.004,-344.694,-346.419,-347.772,-349.962,-351.944,-353.968,-355.349,-356.620,-358.279,-358.857,-360.894,-362.022,-362.629,-363.434,-364.254,-364.799,-365.520,-366.167,-366.837,-367.421,-368.039,-368.407,-368.925,-369.731,-370.501,-371.240,-371.746,-372.155,-372.614,-373.203,-373.782,-374.387,-375.021,-375.584,-376.089,-376.437,-376.609],
              'y':[626.517,626.334,626.023,625.328,624.764,624.076,623.320,622.846,622.251,621.894,621.954,622.044,622.000,621.628,621.425,620.980,620.773,620.222,619.540,618.440,617.809,617.326,616.583,615.950,615.250,614.675,614.174,613.285,612.174,611.035,610.287,609.153,607.959,606.765,605.632,604.495,603.297,602.175,600.998,599.897,598.823,597.818,597.010],
              'z':[-437.758,-438.020,-438.695,-439.754,-440.313,-440.652,-440.793,-441.055,-441.318,-441.758,-441.967,-442.042,-441.938,-441.496,-441.763,-442.474,-443.062,-443.507,-443.948,-444.400,-445.469,-446.166,-447.193,-447.688,-448.089,-448.664,-449.863,-450.761,-451.364,-451.641,-451.743,-452.185,-452.545,-452.985,-453.552,-454.056,-454.358,-454.898,-455.250,-455.831,-456.513,-457.299,-458.318],
              'diam':[0.419,0.368,0.245,0.245,0.307,0.429,0.307,0.592,0.613,0.981,0.797,0.429,0.307,0.531,0.245,0.480,0.480,0.245,0.245,0.245,0.245,0.245,0.429,0.592,0.541,0.643,0.245,0.429,0.480,0.981,0.909,0.368,0.429,0.245,0.245,0.245,0.245,0.245,0.307,0.592,0.429,0.715,0.981]
          },

          prefix + 'apic[6]': {
              'x':[-451.962,-453.110,-454.147,-455.260,-456.265,-457.174,-458.049,-459.414,-460.155,-461.028,-461.711,-462.458,-463.078,-463.774,-464.608,-465.438,-466.086,-467.285,-468.865,-471.078,-472.673,-474.078,-475.735,-478.215],
              'y':[645.558,645.762,646.008,646.092,646.092,645.921,646.029,646.149,645.603,644.700,643.746,642.969,642.567,641.974,641.218,640.417,639.832,639.141,639.281,639.647,639.874,639.910,640.098,640.439],
              'z':[-393.815,-393.443,-392.686,-392.399,-392.105,-391.371,-390.594,-389.982,-389.477,-388.741,-387.991,-387.104,-385.919,-384.872,-383.941,-383.071,-382.569,-381.757,-381.674,-381.654,-381.477,-380.797,-380.639,-380.639],
              'diam':[0.652,0.634,0.626,0.620,0.616,0.612,0.608,0.604,0.601,0.597,0.594,0.591,0.588,0.585,0.582,0.580,0.578,0.575,0.572,0.568,0.566,0.564,0.561,0.557]
          },

          prefix + 'apic[8]': {
              'x':[-423.110,-423.608,-423.903,-424.267,-424.661,-424.987,-425.361,-425.681,-426.240,-426.878,-427.373,-427.842,-428.493,-430.018,-431.007,-431.563,-432.597,-433.299,-433.704,-434.980,-435.527,-435.738,-435.918,-436.183,-437.568,-438.881,-439.345,-439.924,-440.794,-441.664,-442.590,-443.861,-445.142,-446.099,-447.707,-448.968,-450.006,-451.101,-451.948,-452.690,-455.408,-456.802,-457.599,-458.142,-459.724,-460.996,-463.014,-463.907,-464.287,-464.928,-465.907,-466.914,-468.879,-470.735,-471.837,-472.839,-474.048,-475.096,-475.540,-476.000,-476.629,-477.703,-479.450,-480.626,-481.380,-481.920,-482.153,-482.151,-482.133,-482.036,-481.608,-481.150,-480.654,-479.323,-476.591,-474.358,-473.308,-472.100,-469.789,-467.027,-465.086,-464.016,-461.859,-459.752,-457.745,-456.750],
              'y':[647.320,647.930,648.858,649.556,650.239,651.133,651.823,652.389,653.006,653.772,654.518,655.319,656.169,656.701,657.150,657.508,658.089,658.814,659.764,660.568,661.411,662.514,663.640,664.744,665.561,666.201,667.133,667.557,667.706,667.377,667.086,667.091,667.024,666.515,666.142,666.021,665.822,665.176,664.509,664.065,664.347,664.552,664.920,665.254,665.726,666.113,666.868,667.854,668.804,669.758,670.774,671.284,671.832,672.266,672.420,672.470,672.645,673.117,673.767,674.461,675.079,675.475,675.706,675.663,675.688,676.117,676.318,676.071,675.328,674.260,673.565,673.075,672.710,672.534,672.306,672.185,672.251,672.274,671.970,671.550,671.418,671.982,672.234,672.005,671.541,671.087],
              'z':[-388.522,-387.890,-386.947,-385.837,-384.713,-383.725,-382.610,-381.422,-380.259,-379.178,-378.078,-377.018,-376.000,-375.360,-374.642,-373.838,-373.196,-372.633,-371.691,-371.400,-371.080,-370.294,-369.588,-368.821,-368.455,-367.874,-366.905,-366.151,-365.361,-364.205,-363.565,-363.421,-363.333,-362.866,-362.506,-362.445,-362.387,-362.179,-361.901,-361.374,-360.964,-360.718,-359.988,-359.215,-358.576,-357.871,-357.675,-357.652,-357.591,-357.459,-357.370,-357.305,-357.320,-357.255,-356.998,-356.701,-356.459,-355.776,-355.144,-354.566,-353.927,-353.194,-352.576,-351.858,-350.601,-349.387,-348.120,-346.831,-345.773,-344.985,-343.788,-342.963,-342.112,-341.610,-341.109,-340.692,-340.333,-340.022,-339.759,-339.525,-339.280,-338.840,-338.350,-338.072,-337.824,-337.577],
              'diam':[0.613,0.653,0.429,0.245,0.245,0.429,0.429,0.480,0.837,0.245,0.307,0.245,0.480,0.541,0.307,0.307,0.592,0.429,0.480,0.480,0.307,0.307,0.307,0.909,0.909,0.480,0.491,0.736,0.592,0.715,0.766,0.643,0.592,0.694,0.766,0.837,0.766,0.694,0.694,0.837,0.725,0.491,0.429,0.552,0.664,0.909,0.613,0.491,0.491,0.643,0.909,0.981,0.909,0.837,0.909,0.858,0.613,0.541,0.643,0.491,0.541,0.766,0.837,0.715,0.491,0.491,0.429,0.480,0.766,0.909,0.541,0.491,0.643,0.694,0.694,0.694,0.694,0.766,0.837,0.653,0.357,0.552,0.837,0.837,0.715,0.541]
          },

          prefix + 'apic[3]': {
              'x':[-360.145,-360.354,-361.070,-361.961,-362.694,-363.422,-364.216,-364.846,-365.483,-366.199,-366.827,-367.755,-368.466,-370.560,-372.168,-373.689,-374.942,-375.994,-376.889,-377.566,-378.361,-378.938,-379.581,-380.262,-381.037,-381.881,-383.050,-384.129,-385.303,-386.313,-387.096,-387.961,-388.615,-389.418,-390.145,-390.831,-391.196,-391.390,-391.296,-391.366,-391.969,-393.472,-394.443,-395.184,-396.081,-396.944,-397.668,-398.418,-399.086,-399.851,-400.770,-401.565,-402.117,-402.702,-403.267,-404.107,-404.984,-405.620,-406.365,-407.094,-407.834,-408.532,-409.291,-410.020,-411.002,-412.004,-413.497,-414.247,-414.876,-415.467,-415.957,-416.725,-417.581,-418.314,-419.682,-420.834,-421.521,-422.701,-424.260,-425.804,-426.933,-427.971,-429.029,-430.313,-431.112,-431.056,-431.412,-431.738,-432.745,-434.718,-436.624,-437.901,-439.295,-440.541,-441.477,-442.259,-443.108,-443.799,-444.984,-446.168,-447.396,-448.115,-448.862],
              'y':[625.453,624.477,623.520,622.775,622.109,621.184,620.150,619.612,618.906,618.390,618.089,617.453,616.829,616.487,616.449,616.392,616.259,615.635,614.601,614.052,613.203,612.278,611.471,610.772,609.951,609.195,608.498,608.388,608.279,608.176,607.805,607.074,606.490,605.613,604.668,603.858,603.011,601.829,600.700,599.635,598.496,597.988,597.388,596.621,595.711,595.104,594.241,593.362,592.925,592.348,591.628,590.883,590.036,589.049,587.884,586.776,585.644,584.429,583.270,582.620,581.950,580.823,579.688,578.975,578.315,578.098,577.639,576.854,576.186,575.726,575.265,574.339,573.203,572.512,572.088,571.876,571.547,571.104,571.128,571.138,570.561,569.986,569.831,569.256,568.110,567.067,565.899,564.838,564.389,564.530,564.616,564.571,564.569,564.485,563.872,563.167,562.436,561.673,561.044,560.916,560.371,559.687,559.193],
              'z':[-426.047,-425.682,-424.972,-424.046,-423.043,-422.280,-421.717,-421.152,-420.145,-419.035,-418.295,-417.328,-416.912,-416.760,-416.770,-416.778,-416.745,-416.553,-416.054,-415.535,-414.687,-413.875,-412.973,-411.987,-411.113,-410.200,-409.369,-409.339,-409.407,-409.310,-408.690,-407.764,-407.248,-406.455,-405.705,-404.816,-403.886,-403.404,-402.710,-402.098,-401.926,-401.730,-401.410,-400.491,-399.777,-398.763,-397.906,-397.094,-396.468,-395.408,-394.477,-393.542,-392.643,-391.911,-391.515,-391.171,-391.002,-391.090,-390.830,-390.462,-390.126,-389.740,-389.361,-389.122,-388.913,-388.863,-388.555,-387.646,-386.615,-385.462,-384.289,-383.583,-383.280,-383.038,-382.631,-381.974,-381.273,-380.825,-380.696,-380.598,-380.354,-380.087,-379.994,-379.809,-379.366,-379.125,-378.630,-377.939,-377.508,-377.548,-377.569,-377.460,-377.446,-377.600,-378.066,-378.347,-378.408,-378.393,-378.395,-378.361,-378.100,-377.808,-377.362],
              'diam':[0.981,0.491,0.613,0.480,0.245,0.245,0.429,0.307,0.245,0.858,0.715,0.368,0.613,1.083,1.083,1.133,1.062,0.541,0.592,0.491,0.245,0.245,0.715,0.541,0.541,0.715,0.837,0.766,0.643,0.480,0.429,0.480,0.480,0.245,0.429,0.307,0.429,0.491,0.307,0.368,0.541,0.541,0.307,0.480,0.491,0.491,0.245,0.491,0.429,0.307,0.643,0.245,0.429,0.368,0.307,0.368,0.643,0.368,0.858,0.858,0.429,0.307,0.643,0.541,0.694,0.643,0.429,0.245,0.245,0.245,0.307,0.245,0.643,0.694,0.643,0.491,0.541,0.592,0.592,0.541,0.491,0.643,0.694,0.643,0.507,0.515,0.521,0.526,0.529,0.534,0.537,0.540,0.542,0.544,0.546,0.547,0.549,0.550,0.552,0.553,0.555,0.556,0.557]
          },

          prefix + 'apic[5]': {
              'x':[-423.110,-425.729,-427.116,-428.054,-429.426,-431.078,-432.884,-434.232,-435.251,-435.938,-436.867,-437.591,-438.599,-440.476,-442.509,-444.618,-446.939,-448.479,-450.022,-451.962],
              'y':[647.320,647.770,647.825,647.456,647.038,647.068,647.182,647.190,646.737,646.132,644.999,644.252,644.087,644.175,644.297,644.456,644.710,644.943,645.167,645.558],
              'z':[-388.522,-388.734,-389.208,-389.939,-390.499,-390.759,-391.093,-391.423,-392.034,-392.530,-392.602,-392.725,-392.824,-393.037,-393.306,-393.578,-393.841,-393.968,-394.095,-393.815],
              'diam':[0.613,0.787,0.755,0.743,0.732,0.722,0.713,0.707,0.701,0.697,0.692,0.688,0.684,0.678,0.672,0.665,0.659,0.652,0.652,0.652]
          },

          prefix + 'soma': {
              'x':[-227.963,-228.077,-228.191],
              'y':[616.445,616.487,616.530],
              'z':[-445.972,-446.452,-446.932],
              'diam':[0.990,0.990,0.990]
          },

          prefix + 'apic[0]': {
              'x':[-228.292,-229.285,-230.901,-232.670,-233.931,-235.107,-236.696,-238.493,-240.046,-241.500,-242.726,-244.451,-245.625,-246.629,-248.443,-249.787,-250.954,-252.806,-254.662,-256.435,-257.794,-258.850,-261.009,-262.842,-264.705,-266.234,-268.288,-269.934,-271.316,-272.555,-274.037,-275.817,-277.979,-280.230,-281.831,-283.018,-283.645,-284.254,-284.815,-285.334,-285.799,-286.711,-288.574,-290.157,-291.491,-293.087,-295.232,-296.685,-297.753,-299.322,-300.057,-301.693,-302.982,-304.149,-305.371,-306.495,-307.618,-308.981,-310.387,-311.466,-312.405,-314.277,-315.481,-316.152,-317.311,-318.447,-320.350,-321.642,-322.306,-323.691,-325.045,-326.562,-327.374,-328.437,-330.347,-332.480,-334.793,-337.181,-339.122],
              'y':[616.530,616.455,616.580,616.637,616.523,616.402,616.440,616.622,616.785,616.455,615.873,615.417,614.946,614.819,614.895,614.820,614.257,613.848,613.892,613.949,613.979,613.726,613.738,613.899,613.985,613.929,613.504,613.473,613.356,613.178,613.082,613.110,613.361,613.734,613.910,613.746,613.680,614.028,614.540,615.114,615.891,616.360,616.846,617.254,618.030,618.501,618.995,619.436,620.258,620.922,621.175,621.504,621.527,621.573,621.833,622.291,622.647,622.956,623.337,623.546,623.607,623.916,623.889,624.077,624.521,624.992,625.419,625.339,625.300,625.670,625.869,625.920,625.800,625.842,626.043,626.289,626.544,626.691,626.517],
              'z':[-446.880,-448.169,-448.493,-448.772,-449.034,-449.304,-449.627,-449.992,-450.388,-451.034,-451.457,-451.905,-452.499,-452.741,-452.985,-453.225,-453.698,-454.126,-454.276,-454.475,-454.809,-455.605,-456.392,-456.709,-456.940,-457.100,-457.288,-457.400,-457.515,-457.593,-457.713,-457.867,-458.150,-458.367,-458.271,-457.593,-456.795,-456.024,-455.293,-454.621,-454.134,-454.062,-454.100,-453.978,-453.519,-453.474,-453.464,-453.324,-452.854,-452.269,-451.480,-450.839,-450.127,-449.406,-449.160,-448.464,-447.722,-447.504,-447.315,-447.055,-446.274,-445.710,-445.011,-444.203,-443.480,-442.788,-442.177,-441.495,-440.689,-439.976,-439.261,-438.560,-437.790,-437.564,-437.506,-437.480,-437.522,-437.529,-437.758],
              'diam':[0.592,0.736,0.674,0.491,0.480,0.643,0.582,0.357,0.245,0.245,0.307,0.491,0.715,0.787,0.664,0.715,0.664,0.888,0.787,0.736,0.613,0.613,0.909,0.837,0.837,0.766,0.787,0.613,0.491,0.541,0.715,0.909,0.981,0.858,0.552,0.245,0.245,0.307,0.368,0.368,0.541,0.766,0.939,0.888,0.909,0.766,0.694,0.643,0.592,0.429,0.480,0.541,0.541,0.643,0.541,0.541,0.694,0.694,0.582,0.357,0.552,0.613,0.491,0.715,0.766,0.694,0.357,0.307,0.592,0.491,0.643,0.541,0.715,0.837,0.766,0.694,0.694,0.694,0.419]
          },

          prefix + 'apic[4]': {
              'x':[-360.145,-361.707,-362.880,-363.551,-364.902,-366.841,-368.104,-369.381,-370.221,-370.927,-372.881,-374.504,-376.013,-377.408,-378.633,-380.211,-381.182,-382.213,-383.134,-383.731,-384.404,-385.227,-385.896,-386.806,-388.434,-390.509,-391.740,-392.526,-393.174,-394.263,-395.285,-396.865,-398.253,-399.676,-401.175,-402.242,-403.093,-404.119,-404.815,-405.571,-406.295,-407.085,-407.823,-408.289,-408.915,-410.244,-411.343,-411.898,-412.320,-412.769,-413.233,-413.869,-414.532,-414.914,-415.395,-415.886,-416.462,-416.926,-417.473,-418.467,-419.363,-419.984,-420.704,-421.682,-422.416,-423.110],
              'y':[625.453,625.876,626.360,627.079,627.797,628.488,628.900,629.369,629.378,629.185,629.213,629.302,629.305,628.887,628.670,628.907,629.165,629.467,630.086,630.975,631.194,631.108,631.071,631.329,631.655,631.961,632.008,631.842,631.811,631.853,631.938,631.970,632.029,632.024,631.701,631.142,630.455,629.939,629.702,629.718,630.019,630.417,631.057,631.915,632.796,633.592,634.318,635.165,635.952,636.684,637.410,638.389,639.180,640.360,641.255,642.274,642.861,643.433,644.004,644.454,644.874,645.275,645.699,646.157,646.583,647.320],
              'z':[-426.047,-425.957,-425.846,-425.289,-424.725,-424.161,-423.925,-423.244,-422.471,-421.704,-421.184,-421.051,-420.949,-420.529,-419.926,-419.244,-418.953,-418.661,-418.015,-417.019,-416.229,-415.450,-414.653,-413.901,-413.810,-413.785,-413.577,-412.825,-412.015,-411.253,-410.942,-410.290,-410.128,-410.012,-409.544,-409.184,-408.951,-408.550,-407.814,-406.558,-405.769,-404.994,-404.399,-404.038,-403.664,-403.182,-402.663,-402.248,-401.747,-401.205,-400.646,-399.700,-398.661,-398.041,-397.068,-396.188,-395.522,-394.831,-394.146,-393.413,-392.653,-391.882,-391.115,-390.378,-389.617,-388.522],
              'diam':[0.981,0.981,0.858,0.541,0.909,0.766,0.694,0.419,0.491,0.766,0.939,0.827,0.480,0.552,0.858,0.643,0.694,0.643,0.307,0.491,0.592,0.491,0.368,0.643,0.694,0.582,0.357,0.245,0.429,0.592,0.592,0.787,0.613,0.429,0.307,0.541,0.643,0.592,0.429,0.480,0.694,0.787,0.541,0.541,0.643,0.592,0.694,0.541,0.491,0.491,0.368,0.491,0.307,0.245,0.245,0.429,0.491,0.491,0.613,0.715,0.429,0.429,0.643,0.694,0.592,0.613]
          },


        }
